<?php

namespace App\Form;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\Extension\Core\Type\TextType;
use Symfony\Component\Form\Extension\Core\Type\TextareaType;
use Symfony\Component\Form\Extension\Core\Type\CheckboxType;
use Symfony\Component\Form\Extension\Core\Type\ChoiceType;
use Symfony\Bridge\Doctrine\Form\Type\EntityType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\OptionsResolver\OptionsResolver;

class CommitmentType extends AbstractType
{
    /**
     * @param FormBuilderInterface $builder
     * @param array $options
     */
    public function buildForm(FormBuilderInterface $builder, array $options)
    {

        $builder
        ->add('department', EntityType::class, array(
            'class'=>Department::class,
            'label' => 'Für Ressort (ohne Garantie)',
            'choices' => $options['departmentChoices'],
            'choice_label' => function ($dpt) {
                                    return $dpt->getLongText();
                                }
        ))
        ->add('possibleStart', TextareaType::class, array(
            'label' => 'Ich helfe an folgenden Tagen (bitte auch Zeit angeben)',
            'attr' => array(
                'rows' => 4
            )
        ))
        ->add('shirtSize', ShirtSizeType::class, array(
            'label' => 'TShirt Grösse',
        ))
        ->add('needTrainTicket', CheckboxType::class, array(
            'label' => 'Ich brauche ein Zugbillet',
            'required' => false,
        ))
        ->add('remark', TextareaType::class, array(
            'label' => "Bemerkung / Wunsch",
            'required' => false
        ))
        ->add('message', TextareaType::class, array(
                    'label' => "Diese Nachricht an den Hölfer senden:",
                    'required' => false,
                    'mapped' => false,
                    'attr' => array('class'=>'clx-commitment-message'),
        ))
        ->add('noMessage', CheckboxType::class, array(
            'label' => "Keine Nachricht an den Hölfer senden.",
            'required' => false,
            'mapped' => false,
        ))
        ;
    }

    /**
     * @param OptionsResolver $resolver
     */
    public function configureOptions(OptionsResolver $resolver)
    {
        $resolver->setDefaults(array(
            'data_class' => Commitment::class,
            'departmentChoices' => array()
        ));

        $resolver->isRequired('departmentChoices');
    }
}
